@let quiz = this.quiz.value();

@if (quiz) {
  <h2>{{ quiz.title }}</h2>
  @let status = this.status();

  <p>Status:</p>
  <p>
    <span class="text-green-500 pr-4">Correct: {{ status.correct }}</span
    ><span class="text-red-500">Incorrect: {{ status.incorrect }}</span>
  </p>

  @for (question of quiz.questions; track question) {
    <mat-card class="max-w-lg my-4">
      <mat-card-header>{{ question.question }}</mat-card-header>
      <mat-card-content>
        <div
          class="grid gap-4 w-full my-4"
          [class]="
            question.choices.length === 3 ? 'grid-cols-3' : 'grid-cols-2'
          "
        >
          @for (choice of question.choices; track choice) {
            <button
              mat-raised-button
              (click)="handleAnswer(question.id, choice.id)"
            >
              {{ choice.text }}
            </button>
          }
        </div>

        @if (question.status !== "unanswered") {
          <div
            class="my-2 border-2 p-1"
            [class]="
              question.status === 'correct'
                ? 'border-green-500'
                : 'border-red-500'
            "
          >
            @switch (question.status) {
              @case ("correct") {
                <p class="text-green-500 font-bold">Right Answer</p>
              }
              @case ("incorrect") {
                <p class="text-red-500 font-bold">Wrong Answer</p>
              }
            }

            <p class="italic">{{ question.explanation }}</p>
          </div>
        }
      </mat-card-content>
    </mat-card>
  }
}
